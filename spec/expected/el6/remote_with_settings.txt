ruleset(
  name="ruleset_test_name"
) {
  action(
    type="omfwd"
    template="my_template"
    protocol="relp"
    target="1.2.3.4"
    port="514"
    TCP_Framing="octet-counted"
    ZipLevel="1"
    RebindInterval="1"
    ResendLastMSGOnReconnect="off"
  )

  action(
    type="omfwd"
    template="my_template"
    protocol="relp"
    target="5.6.7.8"
    port="5678"
    TCP_Framing="octet-counted"
    ZipLevel="1"
    RebindInterval="1"
    ResendLastMSGOnReconnect="off"
    action.resumeRetryCount="1"
    action.execOnlyWhenPreviousIsSuspended="on"
  )

  action(
    type="omfwd"
    template="my_template"
    protocol="relp"
    target="9.10.11.12"
    port="514"
# NOTE: This must exist for the last failover host so that we can queue logs to disk when needed.
    queue.filename="my_queue_action"
    queue.size="1000"
    queue.dequeuebatchsize="100"
    queue.maxdiskspace="100000"
    queue.highwatermark="900"
    queue.lowwatermark="200"
    queue.fulldelaymark="940"
    queue.lightdelaymark="300"
    queue.discardmark="975"
    queue.discardseverity="7"
    queue.checkpointinterval="2"
    queue.syncqueuefiles="on"
    queue.type="LinkedList"
    queue.workerthreads="2"
    queue.timeoutshutdown="1"
    queue.timeoutactioncompletion="100"
    queue.timeoutenqueue="200"
    queue.timeoutworkerthreadshutdown="6000"
    queue.workerthreadminimummessages="10"
    queue.maxfilesize="2m"
    queue.saveonshutdown="on"
    queue.dequeueslowdown="0"
    queue.dequeuetimebegin="1"
    queue.dequeuetimeend="2"
    TCP_Framing="octet-counted"
    ZipLevel="1"
    RebindInterval="1"
    ResendLastMSGOnReconnect="off"
    action.resumeRetryCount="1"
    action.execOnlyWhenPreviousIsSuspended="on"
  )
  stop
}

if (test_rule) then call ruleset_test_name
